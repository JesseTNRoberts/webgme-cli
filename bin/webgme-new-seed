#!/usr/bin/env node

'use strict';
var Command = require('commander').Command,
    SeedManager = require('../lib/SeedManager'),
    program = new Command(),
    nop = require('nop');

program
    .arguments('<projects...>')
    .description('Create a seed from an existing WebGME project')
    .option('-n, --seed-name [name]', 'Create different name for the seed')
    .option('-u, --user [name]', 'User with access to the seed project (if using authentication)')
    .option('-b, --branch [branch]', 'Branch to use. Default is master')
    .option('-f, --file <file path>', 'Create seed from existing project file')
    .action(function() {
        var manager = new SeedManager(),
            projects = program.args[0],
            total = projects.length;

        // Seed generation has a bug where it needs to be killed manually :/
        projects.forEach(function(proj) {
            program.project = proj;
            manager.new(program, function(err) {
                if (--total === 0 || err) {
                    process.exit(!!err);
                }
            });
        });
    })
    .parse(process.argv);
